{"mappings":"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","sources":["src/js/infinite-scroll.js"],"sourcesContent":["import { fetchByQuery } from './pixabay-api';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport Notiflix from 'notiflix';\nimport 'notiflix/dist/notiflix-3.2.6.min.css';\n\nlet page = 1;\nlet totalHitsGlobal = 0;\nlet searchQuery = '';\nlet isLoading = false;\nconst lightbox = new SimpleLightbox('.gallery a');\n\nconst elements = {\n  form: document.querySelector('.search-form'),\n  input: document.querySelector('input[name=\"searchQuery\"]'),\n  gallery: document.querySelector('.gallery'),\n  submitBtn: document.querySelector('button[type=\"submit\"]'),\n};\n\nelements.form.addEventListener('submit', handleSubmit);\nwindow.addEventListener('scroll', handleScroll);\n\nasync function handleSubmit(event) {\n  event.preventDefault();\n  window.addEventListener('scroll', handleScroll);\n  searchQuery = elements.input.value.trim();\n  page = 1;\n  elements.gallery.innerHTML = '';\n\n  if (searchQuery === '') {\n    Notiflix.Notify.failure('Input query to start search');\n    return;\n  }\n\n  try {\n    const { totalHits } = await fetchByQuery(searchQuery, page);\n    totalHitsGlobal = totalHits;\n    if (totalHits === 0) {\n      Notiflix.Notify.info(\n        'Sorry, nothing was found according your serch query'\n      );\n    } else {\n      Notiflix.Notify.info(`Hooray! We found ${totalHits} images.`);\n      await fetchAndDisplay();\n    }\n  } catch (error) {\n    Notiflix.Notify.failure('Something went wrong. Try reload the page');\n    console.error('There was a problem with the fetch operation:', error);\n  }\n}\n\nasync function handleLoadMore() {\n  if (isLoading) return;\n  isLoading = true;\n  page += 1;\n  await fetchAndDisplay();\n  //    плавне прокручування\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nfunction handleScroll() {\n  if (isLoading) return;\n\n  const { scrollTop, scrollHeight, clientHeight } = document.documentElement;\n  if (scrollTop + clientHeight >= scrollHeight - 50) {\n    handleLoadMore();\n  }\n}\n\nasync function fetchAndDisplay() {\n  try {\n    isLoading = true;\n    const { hits, totalHits } = await fetchByQuery(searchQuery, page);\n    const markup = createMarkup(hits);\n    elements.gallery.insertAdjacentHTML('beforeend', markup);\n\n    lightbox.refresh();\n\n    if (page * 40 >= totalHits && totalHits > 0 && page > 1) {\n      Notiflix.Notify.info(\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n      window.removeEventListener('scroll', handleScroll);\n    }\n  } catch (error) {\n    Notiflix.Notify.failure('Something went wrong. Try reload the page');\n    console.error('There was a problem with the fetch operation:', error);\n  } finally {\n    isLoading = false;\n  }\n}\n\nfunction createMarkup(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `<div class=\"photo-card\">\n  <a href=\"${largeImageURL}\">\n    <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n  </a>\n  <div class=\"info\">\n  <div class=\"info-item\">\n    <i class=\"fas fa-heart\"></i> <!-- іконка для Likes -->\n    <span>${likes}</span>\n  </div>\n  <div class=\"info-item\">\n    <i class=\"fas fa-eye\"></i> <!-- іконка для Views -->\n    <span>${views}</span>\n  </div>\n  <div class=\"info-item\">\n    <i class=\"fas fa-comments\"></i> <!-- іконка для Comments -->\n    <span>${comments}</span>\n  </div>\n  <div class=\"info-item\">\n    <i class=\"fas fa-download\"></i> <!-- іконка для Downloads -->\n    <span>${downloads}</span>\n  </div>\n</div>\n</div>`\n    )\n    .join('');\n}\n"],"names":["$bpxeT","parcelRequire","$93b54f497d416715$var$page","$93b54f497d416715$var$searchQuery","$93b54f497d416715$var$isLoading","$93b54f497d416715$var$lightbox","$parcel$interopDefault","$5IjG7","$93b54f497d416715$var$elements","form","document","querySelector","input","gallery","submitBtn","$93b54f497d416715$var$_handleSubmit","$2TvXO","mark","_callee","event","totalHits","preventDefault","window","addEventListener","$93b54f497d416715$var$handleScroll","value","trim","innerHTML","$6JpON","Notify","failure","$8H72y","fetchByQuery","_ctx","sent","info","concat","$93b54f497d416715$var$fetchAndDisplay","console","error","t0","apply","this","arguments","$93b54f497d416715$var$_handleLoadMore","ref","cardHeight","firstElementChild","getBoundingClientRect","height","scrollBy","top","behavior","_documentElement","documentElement","scrollTop","scrollHeight","clientHeight","$93b54f497d416715$var$handleLoadMore","$93b54f497d416715$var$_fetchAndDisplay","hits","markup","$93b54f497d416715$var$createMarkup","insertAdjacentHTML","refresh","removeEventListener","arr","map","param","webformatURL","largeImageURL","tags","likes","views","comments","downloads","join"],"version":3,"file":"infinite-scroll.c7917436.js.map"}