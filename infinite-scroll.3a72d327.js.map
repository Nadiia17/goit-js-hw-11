{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,S,0BAQA,IAAIC,EAAO,EACPC,EAAkB,EAClBC,EAAc,GACdC,GAAY,EAChB,MAAMC,EAAW,IAAIC,EAAAC,GAAJ,CAAmB,cAE9BC,EAAW,CACfC,KAAMC,SAASC,cAAc,gBAC7BC,MAAOF,SAASC,cAAc,6BAC9BE,QAASH,SAASC,cAAc,YAChCG,UAAWJ,SAASC,cAAc,0BA8CpC,SAASI,IACP,GAAIX,EAAW,OAEf,MAAMY,UAAEA,EAASC,aAAEA,EAAYC,aAAEA,GAAiBR,SAASS,gBACvDH,EAAYE,GAAgBD,EAAe,IApBjDG,iBACE,GAAIhB,EAAW,OACfA,GAAY,EACZH,GAAQ,QACFoB,IAEa,MAAXC,OAAQC,GAAeb,SAC5BC,cAAc,YACda,kBAAkBC,wBAErBC,OAAOC,SAAS,CACdC,IAAkB,EAAbL,EACLM,SAAU,U,CASVC,E,CAIJV,eAAeC,IACb,IACEjB,GAAY,EACZ,MAAM2B,KAAEA,EAAIC,UAAEA,SAAoB,EAAAjC,EAAAkC,cAAa9B,EAAaF,GACtDiC,EAAsBH,EAqB3BI,KACC,EAACC,aACCA,EAAYC,cACZA,EAAaC,KACbA,EAAIC,MACJA,EAAKC,MACLA,EAAKC,SACLA,EAAQC,UACRA,KACI,wCACCL,sBACGD,WAAsBE,8JAK1BC,4HAIAC,oIAIAC,qIAIAC,uCAKPC,KAAK,IArDNnC,EAASK,QAAQ+B,mBAAmB,YAAaV,GAEjD7B,EAASwC,UAEE,GAAP5C,GAAa+B,GAAaA,EAAY,GAAK/B,EAAO,IACpDK,EAAAwC,GAASC,OAAOC,KACd,8DAEFtB,OAAOuB,oBAAoB,SAAUlC,G,CAEvC,MAAOmC,GACP5C,EAAAwC,GAASC,OAAOI,QAAQ,6CACxBC,QAAQF,MAAM,gDAAiDA,E,CAChE,QACC9C,GAAY,C,EAvEhBI,EAASC,KAAK4C,iBAAiB,UAG/BjC,eAA4BkC,GAC1BA,EAAMC,iBACN7B,OAAO2B,iBAAiB,SAAUtC,GAClCZ,EAAcK,EAASI,MAAM4C,MAC7BvD,EAAO,EACPO,EAASK,QAAQ4C,UAAY,GAE7B,IACE,MAAMzB,UAAEA,SAAoB,EAAAjC,EAAAkC,cAAa9B,EAAaF,GACtDC,EAAkB8B,EACA,IAAdA,EACF1B,EAAAwC,GAASC,OAAOC,KACd,wDAGF1C,EAAAwC,GAASC,OAAOC,KAAK,oBAAoBhB,mBACnCX,I,CAER,MAAO6B,GACP5C,EAAAwC,GAASC,OAAOI,QAAQ,6CACxBC,QAAQF,MAAM,gDAAiDA,E,KAtBnExB,OAAO2B,iBAAiB,SAAUtC","sources":["src/js/infinite-scroll.js"],"sourcesContent":["import { fetchByQuery } from './pixabay-api';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport Notiflix from 'notiflix';\nimport 'notiflix/dist/notiflix-3.2.6.min.css';\n\nlet page = 1;\nlet totalHitsGlobal = 0;\nlet searchQuery = '';\nlet isLoading = false;\nconst lightbox = new SimpleLightbox('.gallery a');\n\nconst elements = {\n  form: document.querySelector('.search-form'),\n  input: document.querySelector('input[name=\"searchQuery\"]'),\n  gallery: document.querySelector('.gallery'),\n  submitBtn: document.querySelector('button[type=\"submit\"]'),\n};\n\nelements.form.addEventListener('submit', handleSubmit);\nwindow.addEventListener('scroll', handleScroll);\n\nasync function handleSubmit(event) {\n  event.preventDefault();\n  window.addEventListener('scroll', handleScroll);\n  searchQuery = elements.input.value;\n  page = 1;\n  elements.gallery.innerHTML = '';\n\n  try {\n    const { totalHits } = await fetchByQuery(searchQuery, page);\n    totalHitsGlobal = totalHits;\n    if (totalHits === 0) {\n      Notiflix.Notify.info(\n        'Sorry, nothing was found according your serch query'\n      );\n    } else {\n      Notiflix.Notify.info(`Hooray! We found ${totalHits} images.`);\n      await fetchAndDisplay();\n    }\n  } catch (error) {\n    Notiflix.Notify.failure('Something went wrong. Try reload the page');\n    console.error('There was a problem with the fetch operation:', error);\n  }\n}\n\nasync function handleLoadMore() {\n  if (isLoading) return;\n  isLoading = true;\n  page += 1;\n  await fetchAndDisplay();\n  //    плавне прокручування\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nfunction handleScroll() {\n  if (isLoading) return;\n\n  const { scrollTop, scrollHeight, clientHeight } = document.documentElement;\n  if (scrollTop + clientHeight >= scrollHeight - 50) {\n    handleLoadMore();\n  }\n}\n\nasync function fetchAndDisplay() {\n  try {\n    isLoading = true;\n    const { hits, totalHits } = await fetchByQuery(searchQuery, page);\n    const markup = createMarkup(hits);\n    elements.gallery.insertAdjacentHTML('beforeend', markup);\n\n    lightbox.refresh();\n\n    if (page * 40 >= totalHits && totalHits > 0 && page > 1) {\n      Notiflix.Notify.info(\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n      window.removeEventListener('scroll', handleScroll);\n    }\n  } catch (error) {\n    Notiflix.Notify.failure('Something went wrong. Try reload the page');\n    console.error('There was a problem with the fetch operation:', error);\n  } finally {\n    isLoading = false;\n  }\n}\n\nfunction createMarkup(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `<div class=\"photo-card\">\n  <a href=\"${largeImageURL}\">\n    <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n  </a>\n  <div class=\"info\">\n  <div class=\"info-item\">\n    <i class=\"fas fa-heart\"></i> <!-- іконка для Likes -->\n    <span>${likes}</span>\n  </div>\n  <div class=\"info-item\">\n    <i class=\"fas fa-eye\"></i> <!-- іконка для Views -->\n    <span>${views}</span>\n  </div>\n  <div class=\"info-item\">\n    <i class=\"fas fa-comments\"></i> <!-- іконка для Comments -->\n    <span>${comments}</span>\n  </div>\n  <div class=\"info-item\">\n    <i class=\"fas fa-download\"></i> <!-- іконка для Downloads -->\n    <span>${downloads}</span>\n  </div>\n</div>\n</div>`\n    )\n    .join('');\n}\n"],"names":["$6fOXY","parcelRequire","$7f13665ecc617d63$var$page","$7f13665ecc617d63$var$totalHitsGlobal","$7f13665ecc617d63$var$searchQuery","$7f13665ecc617d63$var$isLoading","$7f13665ecc617d63$var$lightbox","$parcel$interopDefault","$fZKcF","$7f13665ecc617d63$var$elements","form","document","querySelector","input","gallery","submitBtn","$7f13665ecc617d63$var$handleScroll","scrollTop","scrollHeight","clientHeight","documentElement","async","$7f13665ecc617d63$var$fetchAndDisplay","height","cardHeight","firstElementChild","getBoundingClientRect","window","scrollBy","top","behavior","$7f13665ecc617d63$var$handleLoadMore","hits","totalHits","fetchByQuery","markup","map","webformatURL","largeImageURL","tags","likes","views","comments","downloads","join","insertAdjacentHTML","refresh","$7Y9D8","Notify","info","removeEventListener","error","failure","console","addEventListener","event","preventDefault","value","innerHTML"],"version":3,"file":"infinite-scroll.3a72d327.js.map"}